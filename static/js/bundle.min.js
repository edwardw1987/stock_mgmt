"use strict";angular.module("config",[]).config(["$interpolateProvider",function(o){o.startSymbol("[["),o.endSymbol("]]")}]);
"use strict";angular.module("ctrl",[]).controller("scanStockCtrl",["$scope","scan",function(t,n){t.stock={duplicate:[],animate:!1,show:!1,data:{},stockList:[],mOptions:{},isDuplicate:function(){return this.animate=!1,n.getStockByBarcode(this.data.barcode).then(function(t){return console.log(t.data),t.data.success?(this.duplicate.push(this.data.barcode),!0):!(this.duplicate=[])}.bind(this))},save:function(){var e=this;this.isDuplicate().then(function(t){t?e.animate=!0:n.newStock(e.data).then(function(t){t.data.success?window.location.reload():alert("error on create")})})},delete:function(t){return n.delStock(t.id).then(function(t){t.data.success?window.location.reload():alert("error on delete")}),!1},initStockList:function(){var e=this;n.listStock().then(function(t){e.stockList=t.data.stockList,e.show=!0}),n.mOptions().then(function(t){e.mOptions=t.data})}},t.stock.initStockList()}]).controller("scanFlowCtrl",["$scope","$timeout","scan",function(t,o,i){var a=angular.element("#method").val();t.flow={inputBarCode:"",barcodeLines:"",flowList:[],doneList:[],onFly:!1,show:!1,start:function(t){var e=this;this.onFly=!0;for(var n=i[t],o=this.flowList.pop();o;)n(o).then(function(t){t.data.success?e.doneList.push(o):e.flowList.push(o)}),o=this.flowList.pop()},delete:function(t){i.delFlow(t.id).then(function(t){t.data.success&&window.location.reload()})},initFlowList:function(t){var e=this;i.listFlow(t).then(function(t){e.flowList=t.data.flowList,e.show=!0})},animateStockByRowIndex:function(t){var e="lightSpeedIn animated";$("#flow tr").eq(t).addClass(e).on("animationend webkitAnimationEnd oAnimationEnd",function(){$(this).removeClass(e)})},onBarcodeInput:function(t,e){13==t.keyCode&&i.newFlow({method:e,barcode:this.inputBarcode}).then(function(t){window.location.reload()})},promise:null,onQuantityChange:function(t,e){var n=this;null!=t.flowQuantity?(null!=this.promise&&o.cancel(this.promise),this.promise=o(function(){i.updateFlow({method:a,id:t.id,flowQuantity:t.flowQuantity}).then(function(t){console.log(t.data.success),n.promise=null})},500)):t.flowQuantity=parseInt(e)},commit:function(t){i.commitFlow({id:t.id,method:a}).then(function(t){t.data.success?window.location.reload():alert("Fail to commit!")})},onBatchUpload:function(){i.newFlowBatch({method:a,barcodeLines:this.barcodeLines.split("\n")}).then(function(t){window.location.reload()})}},t.flow.initFlowList(a)}]).controller("bugzCtrl",["$scope","$rootScope","$timeout","bugz","uiGridConstants",function(d,i,t,a,u){d.gridOptions={showColumnFooter:!0,enableGridMenu:!0,enableSelectAll:!0,exporterCsvFilename:"myFile.csv",exporterPdfDefaultStyle:{fontSize:9},exporterPdfTableStyle:{margin:[30,30,30,30]},exporterPdfTableHeaderStyle:{fontSize:10,bold:!0,italics:!0,color:"red"},exporterPdfHeader:{text:"My Header",style:"headerStyle"},exporterPdfFooter:function(t,e){return{text:t.toString()+" of "+e.toString(),style:"footerStyle"}},exporterPdfCustomFormatter:function(t){return t.styles.headerStyle={fontSize:22,bold:!0},t.styles.footerStyle={fontSize:10,bold:!0},t},exporterPdfOrientation:"portrait",exporterPdfPageSize:"LETTER",exporterPdfMaxGridWidth:500,exporterCsvLinkElement:angular.element(document.querySelectorAll(".custom-csv-link-location")),onRegisterApi:function(t){d.gridApi=t}},d.gridOptions.columnDefs=[],i.data=null;for(var e=0;e<20;e++){d["gridOptions"+e]=angular.copy(d.gridOptions)}function r(t,e){var n=t.pie[e.split("-")[1]],o=echarts.init(document.getElementById(e)),i={title:{text:n.text,padding:[50,0,0,0],x:"center"},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},series:[{name:n.text,type:"pie",radius:"55%",center:["50%","60%"],data:n.data,itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"},normal:{label:{show:!0,formatter:"{b}:{c}({d}%)"},labelLine:{show:!0,length:10}}}}]};o.setOption(i)}function l(t){var e=$("#mask"),n=$("#loading-icon");void 0===t&&(t="Loading..."),e.fadeIn(200),n.show().find("#loading-hint").text(t)}function s(){var t=$("#mask");$("#loading-icon").hide(),t.hide()}i.getSearchText=function(){if(!i.data||!i.data.data_list)return"project";var t=i.data.data_list;return 1==t.length?t[0].name:t.length+" items"},i.getBugList=function(t,e,n,o){0!=t&&(l(),a.getBugList({q:e,st:n,se:o}).then(function(t){i.bugListData=t.data,s(),$("#bug-list-modal").modal()}))},i.parseLink=function(){a.linkParse({link:i.linkToParse}).then(function(t){0!=t.data.success?i.parsedResult=t.data:alert("Input wrong URL!!!")})},i.cancelParsedResult=function(){i.parsedResult=null},l(),a.getQueryList().then(function(t){return t.data}).then(function(t){var e,n;(e={q:t,cf:"status",rf:"severity"}).q.length?a.search(e).success(function(t){(i.data=t).data_list.forEach(function(o,t){var e=o.data,n=o.cols,i=d["gridOptions"+t];i.columnDefs.push({name:o.row_label,headerCellClass:"blue"}),n.length,n.forEach(function(t,e){var n={name:t,aggregationType:u.aggregationTypes.sum,cellTemplate:'<a href="javascript:;" style="padding-left:5px;" ng-click="grid.appScope.getBugList({{ grid.getCellValue(row,col) }},\''+o.name+"', col.field, row.entity['"+o.row_label+"'])\">{{ grid.getCellValue(row,col) }}</a>"};i.columnDefs.push(n)}),i.data=e,r(o,"pie-cols-"+t),r(o,"pie-rows-"+t)})}):s(),(n={q:t,rf:"status",cf:"severity",aggr:"ActiveDev",atw:1}).q.length&&a.search(n).success(function(t){(i.data2=t).data_list.forEach(function(o,t){var e,n,i,a,r,l=o.data,s=o.cols,c=d["gridOptions"+(10+t)];c.columnDefs.push({name:o.row_label,headerCellClass:"blue"}),s.length,s.forEach(function(t,e){var n={name:t,aggregationType:u.aggregationTypes.sum,cellTemplate:'<a href="javascript:;" style="padding-left:5px;" ng-click="grid.appScope.getBugList({{ grid.getCellValue(row,col) }},\''+o.name+"', row.entity['"+o.row_label+"'], col.field)\">{{ grid.getCellValue(row,col) }}</a>"};c.columnDefs.push(n)}),c.data=l,e=o,n="timeline-"+(10+t),i=echarts.init(document.getElementById(n)),(a={title:{text:"",textStyle:{color:"black",fontStyle:"normal",fontWeight:"bold",fontFamily:"sans-serif",fontSize:20}},tooltip:{trigger:"axis"},legend:{data:e.timeline?e.timeline.status:e.cols},toolbox:{show:!0,orient:"horizontal",x:"right",y:"top",color:["#1e90ff","#22bb22","#4b0082","#d2691e"],backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderWidth:0,padding:5,showTitle:!0,feature:{mark:{show:!0,title:{mark:"辅助线-开关",markUndo:"辅助线-删除",markClear:"辅助线-清空"},lineStyle:{width:1,color:"#1e90ff",type:"dashed"}},dataView:{show:!0,title:"data view",readOnly:!0,lang:["data view","close","refresh"],optionToContent:function(t){for(var e=t.xAxis[0].data,n=t.series,o='<table style="width:100%;text-align:center"><tbody><tr><td></td><td>'+n[0].name+"</td><td>"+n[1].name+"</td></tr>",i=0,a=e.length;i<a;i++)o+="<tr><td>"+e[i]+"</td><td>"+n[0].data[i]+"</td><td>"+n[1].data[i]+"</td></tr>";return o+="</tbody></table>"}},magicType:{show:!0,title:{bar:"柱形图",stack:"堆积",tiled:"平铺"},type:["bar","stack","tiled"]},restore:{show:!0,title:"还原",color:"black"},saveAsImage:{show:!0,title:"保存为图片",type:"jpeg",lang:["点击本地保存"]}}},calculable:!0,dataZoom:{show:!0,realtime:!0,start:0,end:100},xAxis:{type:"category",boundaryGap:!1,data:e.timeline?e.timeline.date:e.rows},yAxis:[{type:"value",minInterval:1}],series:[]}).series=(r=[],e.timeline.series.forEach(function(t){r.push({barWidth:30,name:t.name,type:"line",data:t.data,itemStyle:{normal:{label:{show:!0,position:"top",formatter:function(t){return 0==t.data?"":t.data}}}}})}),r),i.setOption(a)}),s()})})}]).controller("chartBugzProductCtrl",["$scope","$http","$timeout","bugz",function(n,t,o,i){n.syncProuductList=function(){i.getProductList().then(function(t){n.productList=t.data.reverse()})},n.syncProuductList(),n.newProduct={},n.showAlert={saved:!1,deleted:!1},n.onAddProduct=function(){var t=n.newProduct.value,e=n.newProduct.enable||"off";t&&i.productAdd({product:t,enable:e}).then(function(t){var e=[t.data.product].concat(n.productList);n.productList=e,n.newProduct.value="",scope.newProduct.enable=!1})},n.onDelProduct=function(t){i.productDel(t).then(function(t){t.data.success&&(n.showAlert.deleted=!0,n.syncProuductList())}).then(function(){o(function(){n.$apply(function(){n.showAlert.deleted=!1})},2e3)})},n.onSaveProduct=function(t){var e=n.productList[t];i.productSave({id:e.id,value:e.value,enable:e.enable}).then(function(t){t.data.success&&(n.showAlert.saved=!0)}).then(function(){o(function(){n.$apply(function(){n.showAlert.saved=!1})},2e3)})}}]).controller("chartBugzApiCtrl",["$scope","$timeout","bugz",function(e,t,n){e.syncApiconfig=function(){n.getAPIConfig().then(function(t){e.apiConfig=t.data})},e.showAlert={saved:!1,tested:!1},e.syncApiconfig(),e.onSaveApiconfig=function(){n.saveApiconfig(e.apiConfig).then(function(t){t.data.success&&(e.showAlert.saved=!0)}).then(function(){t(function(){e.$apply(function(){e.showAlert.saved=!1})},2e3)})},e.$on("emitSyncApiconfig",e.syncApiconfig)}]).controller("chartBugzEndpointCtrl",["$scope","$http","$timeout","bugz",function(n,t,o,i){n.syncEndpointList=function(){i.getEndpointList().then(function(t){n.endpointList=t.data.reverse()})},n.syncEndpointList(),n.newEndpoint={},n.showAlert={saved:!1,tested:!1},n.onSaveApiConfig=function(){i.saveAPIConfig(n.apiConfig).then(function(t){console.log(t.data)})},n.onAddEndpoint=function(){n.newEndpoint.value&&i.endpointAdd(n.newEndpoint).then(function(t){n.$emit("emitSyncApiconfig");var e=[t.data.endpoint].concat(n.endpointList);n.endpointList=e,n.newEndpoint.value=""})},n.onDelEndpoint=function(t){i.endpointDel(t).then(function(t){t.data.success&&(n.showAlert.deleted=!0,n.syncEndpointList())}).then(function(){o(function(){n.$apply(function(){n.showAlert.deleted=!1})},2e3)})},n.onSaveEndpoint=function(t){var e=n.endpointList[t];i.endpointSave({id:e.id,value:e.value}).then(function(t){t.data.success&&(n.showAlert.saved=!0)}).then(function(){o(function(){n.$apply(function(){n.showAlert.saved=!1})},2e3)})}}]).controller("chartBugzApikeyCtrl",["$scope","$http","$timeout","bugz",function(n,t,o,i){n.syncApikeyList=function(){i.getApikeyList().then(function(t){n.apikeyList=t.data.reverse()})},n.syncApikeyList(),n.newApikey={},n.showAlert={saved:!1,tested:!1},n.onAddApikey=function(){n.newApikey.value&&i.apikeyAdd(n.newApikey).then(function(t){n.$emit("emitSyncApiconfig");var e=[t.data.apikey].concat(n.apikeyList);n.apikeyList=e,n.newApikey.value="",n.newApikey.name=""})},n.onDelApikey=function(t){i.apikeyDel(t).then(function(t){t.data.success&&(n.showAlert.deleted=!0,n.syncApikeyList())}).then(function(){o(function(){n.$apply(function(){n.showAlert.deleted=!1})},2e3)})},n.onSaveApikey=function(t){var e=n.apikeyList[t];i.apikeySave({id:e.id,value:e.value,name:e.name}).then(function(t){t.data.success&&(n.showAlert.saved=!0)}).then(function(){o(function(){n.$apply(function(){n.showAlert.saved=!1})},2e3)})}}]).controller("chartJiraProductCtrl",["$scope","$http","$timeout","jira",function(n,t,o,i){n.syncProuductList=function(){i.getProductList().then(function(t){n.productList=t.data.reverse()})},n.syncProuductList(),n.newProduct={},n.showAlert={saved:!1,deleted:!1},n.onAddProduct=function(){var t=n.newProduct.value,e=n.newProduct.enable||"off";t&&i.productAdd({product:t,enable:e}).then(function(t){var e=[t.data.product].concat(n.productList);n.productList=e,n.newProduct.value="",n.newProduct.enable=!1})},n.onDelProduct=function(t){i.productDel(t).then(function(t){t.data.success&&(n.showAlert.deleted=!0,n.syncProuductList())}).then(function(){o(function(){n.$apply(function(){n.showAlert.deleted=!1})},2e3)})},n.onSaveProduct=function(t){var e=n.productList[t];i.productSave({id:e.id,value:e.value,enable:e.enable}).then(function(t){t.data.success&&(n.showAlert.saved=!0)}).then(function(){o(function(){n.$apply(function(){n.showAlert.saved=!1})},2e3)})}}]).controller("chartJiraApiCtrl",["$scope","$timeout","jira",function(a,t,e){a.syncApiconfig=function(){e.getAPIConfig().then(function(t){a.apiConfig=t.data})},a.showAlert={saved:!1,tested:!1},a.syncApiconfig(),a.onSaveApiconfig=function(){e.saveApiconfig({endpoint:a.apiConfig.endpoint,username:a.apiConfig.auth.username,password:a.apiConfig.auth.password}).then(function(t){t.data.success&&(a.showAlert.saved=!0)}).then(function(){t(function(){a.$apply(function(){a.showAlert.saved=!1})},2e3)})},a.updateApiconfig=function(t,e){for(var n=a.apiConfig.auth,o=0;o<e.length;o++){var i=e[o];if(i.name==n.username&&i.value==n.password){n.index=""+o;break}}a.apiConfig.auth=n,console.log(a.apiConfig.auth)},a.onAuthRadioChange=function(t){a.apiConfig.auth.username=t.name,a.apiConfig.auth.password=t.value},a.$on("emitSyncApiconfig",a.syncApiconfig),a.$on("emitUpdateApiconfig",a.updateApiconfig)}]).controller("chartJiraEndpointCtrl",["$scope","$http","$timeout","jira",function(n,t,o,i){n.syncEndpointList=function(){i.getEndpointList().then(function(t){n.endpointList=t.data.reverse()})},n.syncEndpointList(),n.newEndpoint={},n.showAlert={saved:!1,tested:!1},n.onSaveApiConfig=function(){i.saveAPIConfig(n.apiConfig).then(function(t){console.log(t.data)})},n.onAddEndpoint=function(){n.newEndpoint.value&&i.endpointAdd(n.newEndpoint).then(function(t){n.$emit("emitSyncApiconfig");var e=[t.data.endpoint].concat(n.endpointList);n.endpointList=e,n.newEndpoint.value=""})},n.onDelEndpoint=function(t){i.endpointDel(t).then(function(t){t.data.success&&(n.showAlert.deleted=!0,n.syncEndpointList())}).then(function(){o(function(){n.$apply(function(){n.showAlert.deleted=!1})},2e3)})},n.onSaveEndpoint=function(t){var e=n.endpointList[t];i.endpointSave({id:e.id,value:e.value}).then(function(t){t.data.success&&(n.showAlert.saved=!0)}).then(function(){o(function(){n.$apply(function(){n.showAlert.saved=!1})},2e3)})}}]).controller("chartJiraAuthCtrl",["$scope","$http","$timeout","jira",function(n,t,o,i){n.syncAuthList=function(){i.getAuthList().then(function(t){n.authList=t.data.reverse()}).then(function(){n.$emit("emitSyncApiconfig")})},n.syncAuthList(),n.newAuth={},n.showAlert={saved:!1,tested:!1},n.onAddAuth=function(){n.newAuth.value&&i.authAdd(n.newAuth).then(function(t){n.$emit("emitSyncApiconfig");var e=[t.data.auth].concat(n.authList);n.authList=e,n.newAuth.value="",n.newAuth.name=""})},n.onDelAuth=function(t){i.authDel(t).then(function(t){t.data.success&&(n.showAlert.deleted=!0,n.syncAuthList())}).then(function(){o(function(){n.$apply(function(){n.showAlert.deleted=!1})},2e3)})},n.onSaveAuth=function(t){var e=n.authList[t];i.authSave({id:e.id,value:e.value,name:e.name}).then(function(t){t.data.success&&(n.showAlert.saved=!0)}).then(function(){o(function(){n.$apply(function(){n.showAlert.saved=!1})},2e3)})}}]).controller("chartTlkApiCtrl",["$scope","$timeout","tlk",function(e,t,n){e.syncApiconfig=function(){n.getAPIConfig().then(function(t){e.apiConfig=t.data})},e.showAlert={saved:!1,tested:!1},e.syncApiconfig(),e.onSaveApiconfig=function(){n.saveApiconfig(e.apiConfig).then(function(t){t.data.success&&(e.showAlert.saved=!0)}).then(function(){t(function(){e.$apply(function(){e.showAlert.saved=!1})},2e3)})},e.$on("emitSyncApiconfig",e.syncApiconfig)}]).controller("chartTlkEndpointCtrl",["$scope","$http","$timeout","tlk",function(n,t,o,i){n.syncEndpointList=function(){i.getEndpointList().then(function(t){n.endpointList=t.data.reverse()})},n.syncEndpointList(),n.newEndpoint={},n.showAlert={saved:!1,tested:!1},n.onSaveApiConfig=function(){i.saveAPIConfig(n.apiConfig).then(function(t){console.log(t.data)})},n.onAddEndpoint=function(){n.newEndpoint.value&&i.endpointAdd(n.newEndpoint).then(function(t){n.$emit("emitSyncApiconfig");var e=[t.data.endpoint].concat(n.endpointList);n.endpointList=e,n.newEndpoint.value=""})},n.onDelEndpoint=function(t){i.endpointDel(t).then(function(t){t.data.success&&(n.showAlert.deleted=!0,n.syncEndpointList())}).then(function(){o(function(){n.$apply(function(){n.showAlert.deleted=!1})},2e3)})},n.onSaveEndpoint=function(t){var e=n.endpointList[t];i.endpointSave({id:e.id,value:e.value}).then(function(t){t.data.success&&(n.showAlert.saved=!0)}).then(function(){o(function(){n.$apply(function(){n.showAlert.saved=!1})},2e3)})}}]).controller("chartTlkApikeyCtrl",["$scope","$http","$timeout","tlk",function(n,t,o,i){n.syncApikeyList=function(){i.getApikeyList().then(function(t){n.apikeyList=t.data.reverse()})},n.syncApikeyList(),n.newApikey={},n.showAlert={saved:!1,tested:!1},n.onAddApikey=function(){n.newApikey.value&&i.apikeyAdd(n.newApikey).then(function(t){n.$emit("emitSyncApiconfig");var e=[t.data.apikey].concat(n.apikeyList);n.apikeyList=e,n.newApikey.value="",n.newApikey.name=""})},n.onDelApikey=function(t){i.apikeyDel(t).then(function(t){t.data.success&&(n.showAlert.deleted=!0,n.syncApikeyList())}).then(function(){o(function(){n.$apply(function(){n.showAlert.deleted=!1})},2e3)})},n.onSaveApikey=function(t){var e=n.apikeyList[t];i.apikeySave({id:e.id,value:e.value,name:e.name}).then(function(t){t.data.success&&(n.showAlert.saved=!0)}).then(function(){o(function(){n.$apply(function(){n.showAlert.saved=!1})},2e3)})}}]).controller("chartTlkProductCtrl",["$scope","$http","$timeout","tlk",function(n,t,o,i){n.syncProuductList=function(){i.getProductList().then(function(t){n.productList=t.data.reverse()})},n.syncProuductList(),n.newProduct={},n.showAlert={saved:!1,deleted:!1},n.onAddProduct=function(){var t=n.newProduct.value,e=n.newProduct.enable||"off";t&&i.productAdd({product:t,enable:e}).then(function(t){var e=[t.data.product].concat(n.productList);n.productList=e,n.newProduct.value="",n.newProduct.enable=!1})},n.onDelProduct=function(t){i.productDel(t).then(function(t){t.data.success&&(n.showAlert.deleted=!0,n.syncProuductList())}).then(function(){o(function(){n.$apply(function(){n.showAlert.deleted=!1})},2e3)})},n.onSaveProduct=function(t){var e=n.productList[t];i.productSave({id:e.id,value:e.value,enable:e.enable}).then(function(t){t.data.success&&(n.showAlert.saved=!0)}).then(function(){o(function(){n.$apply(function(){n.showAlert.saved=!1})},2e3)})}}]).controller("MainCtrl",["$scope","$rootScope","bugz","uiGridConstants",function(o,i,n,a){function r(t,e){var n=t.pie[e.split("-")[1]],o=echarts.init(document.getElementById(e)),i={title:{text:n.text,x:"center"},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},series:[{name:n.text,type:"pie",radius:"55%",center:["50%","60%"],data:n.data,itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"},normal:{label:{show:!0,formatter:"{b} : {c} ({d}%)"},labelLine:{show:!0}}}}]};o.setOption(i)}i.searchText="project",o.gridOptions={showColumnFooter:!0,enableGridMenu:!0,enableSelectAll:!0,exporterCsvFilename:"myFile.csv",exporterPdfDefaultStyle:{fontSize:9},exporterPdfTableStyle:{margin:[30,30,30,30]},exporterPdfTableHeaderStyle:{fontSize:10,bold:!0,italics:!0,color:"red"},exporterPdfHeader:{text:"My Header",style:"headerStyle"},exporterPdfFooter:function(t,e){return{text:t.toString()+" of "+e.toString(),style:"footerStyle"}},exporterPdfCustomFormatter:function(t){return t.styles.headerStyle={fontSize:22,bold:!0},t.styles.footerStyle={fontSize:10,bold:!0},t},exporterPdfOrientation:"portrait",exporterPdfPageSize:"LETTER",exporterPdfMaxGridWidth:500,exporterCsvLinkElement:angular.element(document.querySelectorAll(".custom-csv-link-location")),onRegisterApi:function(t){o.gridApi=t}},o.gridOptions.columnDefs=[],i.data=null,n.getQueryList().then(function(t){return t.data}).then(function(t){var e={q:t,cf:"status",rf:"severity"};console.log(e),e.q.length&&(!function(t){var e=$("#mask"),n=$("#loading-icon");void 0===t&&(t="Loading...");e.fadeIn(200),n.show().find("#loading-hint").text(t)}(),n.search(e).success(function(e){i.data=e,i.getSearchText=function(){var t=e.data_list;return 1==t.length?t[0].name:t.length+" items"};var t=e.data,n=e.cols;o.gridOptions.columnDefs.push({name:e.row_label,headerCellClass:"blue"}),n.forEach(function(t){o.gridOptions.columnDefs.push({name:t,aggregationType:a.aggregationTypes.sum})}),o.gridOptions.data=t,r(e,"pie-cols"),r(e,"pie-rows")}))})}]).controller("IssueSummaryCtrl",["$scope","bugz","uiGridConstants",function(s,n,c){s.gridOptions={showColumnFooter:!0,enableGridMenu:!0,enableSelectAll:!0,exporterCsvFilename:"myFile.csv",exporterPdfDefaultStyle:{fontSize:9},exporterPdfTableStyle:{margin:[30,30,30,30]},exporterPdfTableHeaderStyle:{fontSize:10,bold:!0,italics:!0,color:"red"},exporterPdfHeader:{text:"My Header",style:"headerStyle"},exporterPdfFooter:function(t,e){return{text:t.toString()+" of "+e.toString(),style:"footerStyle"}},exporterPdfCustomFormatter:function(t){return t.styles.headerStyle={fontSize:22,bold:!0},t.styles.footerStyle={fontSize:10,bold:!0},t},exporterPdfOrientation:"portrait",exporterPdfPageSize:"LETTER",exporterPdfMaxGridWidth:500,exporterCsvLinkElement:angular.element(document.querySelectorAll(".custom-csv-link-location")),onRegisterApi:function(t){s.gridApi=t}},s.gridOptions.columnDefs=[],n.getQueryList().then(function(t){return t.data}).then(function(t){var e={q:t,rf:"status",cf:"severity",aggr:"ActiveDev",atw:1};e.q.length&&n.search(e).success(function(t){var e;e=$("#mask"),$("#loading-icon").hide(),e.hide();var n,o,i,a,r=t.data,l=t.cols;s.gridOptions.columnDefs.push({name:t.row_label,headerCellClass:"blue"}),l.forEach(function(t){s.gridOptions.columnDefs.push({name:t,aggregationType:c.aggregationTypes.sum})}),s.gridOptions.data=r,n=t,o=echarts.init(document.getElementById("issue-summary")),(i={title:{text:"",textStyle:{color:"black",fontStyle:"normal",fontWeight:"bold",fontFamily:"sans-serif",fontSize:20}},tooltip:{trigger:"axis"},legend:{data:n.timeline?n.timeline.status:n.cols},toolbox:{show:!0,orient:"horizontal",x:"right",y:"top",color:["#1e90ff","#22bb22","#4b0082","#d2691e"],backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderWidth:0,padding:5,showTitle:!0,feature:{mark:{show:!0,title:{mark:"辅助线-开关",markUndo:"辅助线-删除",markClear:"辅助线-清空"},lineStyle:{width:1,color:"#1e90ff",type:"dashed"}},dataView:{show:!0,title:"data view",readOnly:!0,lang:["data view","close","refresh"],optionToContent:function(t){for(var e=t.xAxis[0].data,n=t.series,o='<table style="width:100%;text-align:center"><tbody><tr><td></td><td>'+n[0].name+"</td><td>"+n[1].name+"</td></tr>",i=0,a=e.length;i<a;i++)o+="<tr><td>"+e[i]+"</td><td>"+n[0].data[i]+"</td><td>"+n[1].data[i]+"</td></tr>";return o+="</tbody></table>"}},magicType:{show:!0,title:{bar:"柱形图",stack:"堆积",tiled:"平铺"},type:["bar","stack","tiled"]},restore:{show:!0,title:"还原",color:"black"},saveAsImage:{show:!0,title:"保存为图片",type:"jpeg",lang:["点击本地保存"]}}},calculable:!0,dataZoom:{show:!0,realtime:!0,start:0,end:100},xAxis:{type:"category",boundaryGap:!1,data:n.timeline?n.timeline.date:n.rows},yAxis:[{type:"value",minInterval:1}],series:[]}).series=(a=[],n.timeline.series.forEach(function(t){a.push({barWidth:30,name:t.name,type:"line",data:t.data,itemStyle:{normal:{label:{show:!0,position:"top",formatter:function(t){return 0==t.data?"":t.data}}}}})}),a),o.setOption(i)})})}]).controller("testProgressGridCtrl",["$scope","$rootScope","$timeout","tlk","uiGridConstants",function(i,n,a,o,e){i.gridOptions={showColumnFooter:!0,enableGridMenu:!0,enableSelectAll:!0,exporterCsvFilename:"myFile.csv",exporterPdfDefaultStyle:{fontSize:9},exporterPdfTableStyle:{margin:[30,30,30,30]},exporterPdfTableHeaderStyle:{fontSize:10,bold:!0,italics:!0,color:"red"},exporterPdfHeader:{text:"My Header",style:"headerStyle"},exporterPdfFooter:function(t,e){return{text:t.toString()+" of "+e.toString(),style:"footerStyle"}},exporterPdfCustomFormatter:function(t){return t.styles.headerStyle={fontSize:22,bold:!0},t.styles.footerStyle={fontSize:10,bold:!0},t},exporterPdfOrientation:"portrait",exporterPdfPageSize:"LETTER",exporterPdfMaxGridWidth:500,exporterCsvLinkElement:angular.element(document.querySelectorAll(".custom-csv-link-location")),onRegisterApi:function(t){i.gridApi=t}},i.gridOptions.columnDefs=[],i.gridOptions.columnDefs.push({name:"date",headerCellClass:"blue"});var t=["Attempt","Blocked","Pass","Fail"];t.forEach(function(t){i.gridOptions.columnDefs.push({name:t,aggregationType:e.aggregationTypes.sum})});for(var r=0;r<10;r++){var l="gridOptions"+r;i[l]=angular.copy(i.gridOptions),i[l].columnDefs=[],i[l].columnDefs.push({name:"date",headerCellClass:"blue"}),t.forEach(function(t){i[l].columnDefs.push({name:t})})}var s=$('[name="tlk-pj"]').val(),c=$('[name="tlk-pj-plan"]').val();function d(t,e){o.search({pj:t,vs:e}).then(function(t){n.data=t.data,t.data.progress_list.forEach(function(n,o){i["gridOptions"+o].data=n.grid_data;a(function(){var t=echarts.init(document.getElementById("echart-"+(o+1)));var e={title:{text:n.project+" Testing Progress"},tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}}},legend:{y:"top",right:100,data:["Plan","Pass","Attempt","Blocked","HC"]},toolbox:{feature:{saveAsImage:{}}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:[{type:"category",boundaryGap:!1,data:n.dates,axisLabel:{formatter:function(t,e){return new Date(t).format("M/d")}}}],yAxis:[{max:100,type:"value",axisLabel:{formatter:function(t){return t+"%"}}},{max:10,type:"value",axisLabel:{formatter:function(t){return t+"HC"}}}],series:[{name:"Attempt",type:"line",stack:"总量",areaStyle:{normal:{color:"red"}},lineStyle:{normal:{color:"red"}},itemStyle:{normal:{color:"red"}},data:n.Attempt},{name:"Blocked",type:"line",stack:"总量",areaStyle:{normal:{color:"yellow"}},lineStyle:{normal:{color:"yellow"}},itemStyle:{normal:{color:"yellow"}},data:n.Blocked},{name:"Pass",type:"line",areaStyle:{normal:{color:"green"}},lineStyle:{normal:{color:"green"}},itemStyle:{normal:{color:"green"}},data:n.Pass},{name:"Plan",type:"line",lineStyle:{normal:{color:"blue"}},itemStyle:{normal:{color:"blue",label:{show:!0,position:"top",formatter:function(t){return 0==t.data?"":t.data+"%"}}}},data:n.percents},{name:"HC",type:"line",lineStyle:{normal:{color:"red"}},yAxisIndex:1,step:"start",itemStyle:{normal:{color:"red",label:{show:!0,position:"top",formatter:function(t){return 0==t.data?"":t.data+"HC"}}}},data:n.players}]};t.setOption(e)},666)})})}function u(t){o.search({pj:t}).then(function(t){n.oneProgress=0<t.data.progress_list.length?t.data.progress_list[0]:null,a(function(){$(".flatpickr").flatpickr({wrap:!0,dateFormat:"Y-m-d"})},666)})}n.tlkPj=s||-1,n.tlkPjPlan=c||-1,d(n.tlkPj,$('[name="vs"]').val()),u(n.tlkPjPlan);n.$watch("tlkPj",function(t,e,n){t!=e&&d(t,2)}),n.$watch("tlkPjPlan",function(t,e,n){t!=e&&u(t)})}]).controller("jiraCtrl",["$scope","$rootScope","$timeout","jira","uiGridConstants",function(e,n,o,i,t){e.gridOptions={showColumnFooter:!0,enableGridMenu:!0,enableSelectAll:!0,exporterCsvFilename:"myFile.csv",exporterPdfDefaultStyle:{fontSize:9},exporterPdfTableStyle:{margin:[30,30,30,30]},exporterPdfTableHeaderStyle:{fontSize:10,bold:!0,italics:!0,color:"red"},exporterPdfHeader:{text:"My Header",style:"headerStyle"},exporterPdfFooter:function(t,e){return{text:t.toString()+" of "+e.toString(),style:"footerStyle"}},exporterPdfCustomFormatter:function(t){return t.styles.headerStyle={fontSize:22,bold:!0},t.styles.footerStyle={fontSize:10,bold:!0},t},exporterPdfOrientation:"portrait",exporterPdfPageSize:"LETTER",exporterPdfMaxGridWidth:500,exporterCsvLinkElement:angular.element(document.querySelectorAll(".custom-csv-link-location")),onRegisterApi:function(t){e.gridApi=t}},e.gridOptions.columnDefs=[],n.data=null;n.$watch("jiraPj",function(t,e,n){t!=e&&(console.log(t),r(t,2))});!function(t){var e=$("#mask"),n=$("#loading-icon");void 0===t&&(t="Loading...");e.fadeIn(200),n.show().find("#loading-hint").text(t)}();var a=$('[name="jira-pj"]').val();function r(t,e){i.search({pj:t,vs:e}).success(function(t){var e;n.dataList=t.jiraData,t.jiraData.forEach(function(n){o(function(){for(var t=0;t<n.data.length;t++){var e=n.data[t];l(e,e.id),s(e,e.id)}},666)}),e=$("#mask"),$("#loading-icon").hide(),e.hide()})}function l(t,e){var n,o=echarts.init(document.getElementById("jira-timeline-"+e)),i={title:{text:"",textStyle:{color:"black",fontStyle:"normal",fontWeight:"bold",fontFamily:"sans-serif",fontSize:20}},tooltip:{trigger:"axis"},legend:{data:t.timeline.status},calculable:!0,dataZoom:{show:!0,realtime:!0,start:0,end:100},xAxis:{type:"category",boundaryGap:!1,data:t.timeline.date},yAxis:[{type:"value",minInterval:1}],series:[]};i.series=(n=[],t.timeline.series.forEach(function(t){n.push({barWidth:30,name:t.name,type:"line",data:t.data,itemStyle:{normal:{color:t.color,label:{show:!0,position:"top",formatter:function(t){return 0==t.data?"":t.data}}}}})}),n),o.setOption(i)}function s(t,e){var n,o,i=document.getElementById("jira-assignee-"+e),a=echarts.init(i),r={title:{text:"",textStyle:{color:"black",fontStyle:"normal",fontWeight:"bold",fontFamily:"sans-serif",fontSize:20}},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{data:t.assignee.cols},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"value",minInterval:1},yAxis:{type:"category",data:t.assignee.rows},dataZoom:{show:!0,realtime:!0,start:0,orient:"vertical",end:50}};r.series=(o=[],(n=t).assignee.cols.forEach(function(t){o.push({name:t,type:"bar",stack:"总量",label:{normal:{show:!0,position:"insideRight"}},data:n.assignee[t],itemStyle:{normal:{color:n.assignee.colors[t],label:{show:!0,position:"top",formatter:function(t){return 0==t.data?"":t.data}}}}})}),o),a.setOption(r)}n.jiraPj=a||-1,r(n.jiraPj,$('[name="vs"]').val())}]).controller("perfCtrl",["$scope","$timeout","perf",function(c,e,t){c.perfData={},c.$watch("perfData",function(t,e,n){console.log(e),console.log(t)});var n=function(t){console.log(t),c.perfData=t,e(function(){c.perfData.data.forEach(function(t,e){a(t.echartData,"trend-iops-"+e,e),a(t.echartData,"trend-latency-"+e,e)})},666)};c.updatePerfData=function(t){c.$apply(function(){n(t)})};var o=$('[name="archive"]').val();if(o){var i=store.get(o);i?n(i):t.getArchive(o).then(function(t){store.set(t.data.filename,t.data),n(t.data)})}function a(t,e,n){var o=e.split("-")[1],i=o+"_data";var a,r,l=echarts.init(document.getElementById(e)),s={title:{text:o+"                        "+c.perfData.gridDataList[n].key,textStyle:{color:"black",fontStyle:"normal",fontWeight:"bold",fontFamily:"sans-serif",fontSize:20},padding:[0,0,0,0]},tooltip:{trigger:"axis"},legend:{padding:[30,0,0,0],data:t.legend,bottom:10},calculable:!0,dataZoom:{show:!0,realtime:!0,start:0,end:100,orient:"vertical"},xAxis:{type:"category",boundaryGap:!1,data:t.xAxis,axisLabel:{formatter:function(t,e){return 0===e&&(t+="(iodepth)"),t}}},yAxis:[{type:"value",minInterval:1,max:"latency"==o?100:null}],series:[],toolbox:{show:!0,orient:"horizontal",x:"right",y:"top",color:["#1e90ff","#22bb22","#4b0082","#d2691e"],backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderWidth:0,padding:[0,25,5,5],showTitle:!0,feature:{saveAsImage:{show:!0,title:"保存为图片",type:"jpeg",lang:["点击本地保存"]}}}};s.series=(r=[],(a=t).series.forEach(function(t){r.push({barWidth:30,name:t.name,type:"line",data:t[i],itemStyle:{normal:{label:{show:!0,position:"top",formatter:function(t){return 0==t.data?"":t.data}},color:a.color[t.name]}},lineStyle:{normal:{color:a.color[t.name]}}})}),r),l.setOption(s)}}]);
"use strict";angular.module("filter",[]).filter("hidepasswd",function(){return function(r){if(null!=r){for(var n="",e=0;e<r.password.length;e++)n+="*";return r.username+":"+n}}}).filter("getNumberArray",function(){return function(r){return new Array(parseInt(r))}});
"use strict";angular.module("app",["ngAnimate","rest","config","ctrl","filter"]);
"use strict";angular.module("rest",[]).service("scan",["$http",function(o){this.mOptions=function(){return o({url:"/m/options"})},this.newStock=function(t){return o({url:"/api/stock/",data:t,method:"POST"})},this.delStock=function(t){return o({url:"/api/stock/",data:{action:"delete",id:t},method:"POST"})},this.listStock=function(){return o({url:"/api/stock"})},this.getStockByBarcode=function(t){return o({url:"/api/stock/",params:{barcode:t}})},this.newFlow=function(t){return o({method:"POST",url:"/api/flow/",data:t})},this.newFlowBatch=function(t){return o({method:"POST",url:"/api/flow/batch",data:t})},this.updateFlow=function(t){return t.action="update",o({method:"POST",url:"/api/flow/",data:t})},this.commitFlow=function(t){return t.action="commit",o({method:"POST",url:"/api/flow/",data:t})},this.delFlow=function(t){return o({method:"POST",url:"/api/flow/",data:{action:"delete",id:t}})},this.listFlow=function(t){return o({url:"/api/flow/",params:{method:t}})}}]);